

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Phylogenetics &mdash; ubic_crash_course 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Challenge 2" href="11_Challenge2.html" />
    <link rel="prev" title="Clustering" href="9_1_Clustering.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> ubic_crash_course
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Lessons</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1_Welcome.html">Hello World: What’s the purpose of bioinformatics?</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_LinuxTerminal.html">The Linux Terminal</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_AdvancedTerminal.html">Advanced Command Line + Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_Python.html">Python Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_Biopython.html">Bioinformatics x Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_Challenge1.html">Challenge 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="8.1_Alignment.html">Alignment (Part I)</a></li>
<li class="toctree-l1"><a class="reference internal" href="9_1_Clustering.html">Clustering</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Phylogenetics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-basics">The Basics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-is-phylogenetics">What is Phylogenetics?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#why-do-i-care">Why Do I Care?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-does-it-work">How Does it Work?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#biopython">Biopython</a></li>
<li class="toctree-l2"><a class="reference internal" href="#find-the-relationships">Find the Relationships</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#working-with-trees">Working with Trees</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-data">The Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#what-kind-of-data-goes-into-making-trees">What kind of data goes into making trees?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-setup">The Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#alignment">Alignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#distance-matrix">Distance Matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#phylogenetic-tree">Phylogenetic Tree</a></li>
<li class="toctree-l3"><a class="reference internal" href="#visualization">Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interpretation">Interpretation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#challenge-i-different-algorithms-different-results">Challenge I: Different Algorithms, Different Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#distance-tree-models">Distance Tree Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#unweighted-pair-group-method-with-arithmetic-averaging-upgma">Unweighted Pair-Group Method with Arithmetic Averaging (UPGMA)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#neighbor-joining-nj">Neighbor-Joining (NJ)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#distance-calculation-methods">Distance Calculation Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#identity">Identity</a></li>
<li class="toctree-l4"><a class="reference internal" href="#blastn">Blastn</a></li>
<li class="toctree-l4"><a class="reference internal" href="#trans">Trans</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#acknowledgements">Acknowledgements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="11_Challenge2.html">Challenge 2</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ubic_crash_course</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Phylogenetics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/10_Phylogenetics.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="phylogenetics">
<h1>Phylogenetics<a class="headerlink" href="#phylogenetics" title="Permalink to this headline">¶</a></h1>
<p>Today’s lesson is going to cover basic phylogenetic motifs as well as phylogenetic analysis in a Python environment. Let’s get started!</p>
<div class="section" id="the-basics">
<h2>The Basics<a class="headerlink" href="#the-basics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="what-is-phylogenetics">
<h3>What is Phylogenetics?<a class="headerlink" href="#what-is-phylogenetics" title="Permalink to this headline">¶</a></h3>
<p>At its core, phylogenetics is the study of finding evolutionary relationships between organisms. How, you ask? By looking for similarities (in our case, on the DNA level). Let’s pose one such problem:</p>
<p>Imagine you’re given five distinct organisms and are told to figure out how they’re evolutionarily related (that is, how they evolved from one another). Two questions pop into your head: Why? and How?</p>
</div>
<div class="section" id="why-do-i-care">
<h3>Why Do I Care?<a class="headerlink" href="#why-do-i-care" title="Permalink to this headline">¶</a></h3>
<p>The answer is twofold:</p>
<ol class="simple">
<li><p>On a broader scale, an understanding of phylogenetics gives us a better understanding of the living world, and how we + our fellow organisms fall into it. We can answer questions about how we are linked to jellyfish, and how that relationship has shaped the world around us.</p></li>
<li><p>On a smaller scale, phylogenetics also provides key information about genetic drift, the evolution of genes and diseases, and the development of molecular differences between organisms.</p></li>
</ol>
</div>
<div class="section" id="how-does-it-work">
<h3>How Does it Work?<a class="headerlink" href="#how-does-it-work" title="Permalink to this headline">¶</a></h3>
<p>We need some shared, conserved mechanism of comparing the organisms… something like DNA! There are sequences in DNA that are highly conserved between organisms (usually sequences that code for absolutely essential parts of life) that are excellent candidates for comparison. For example, imagine you have three organisms with the following sequence of DNA in a conserved region:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">ACGTG</span>
<span class="mf">2.</span> <span class="n">ACGTC</span>
<span class="mf">3.</span> <span class="n">ACGCC</span>
</pre></div>
</div>
<p>We can compare the nucleotides at each position and find that 1 and 2 differ by one nucleotide, 2 and 3 differ by one nucleotide, but 1 and 3 differ by <strong>two nucleotides</strong>. This might lead you to conclude that the relationship between organisms 1 and 3 is the most evolutionarily distant.</p>
<p><em>Note: In reality, these conserved sequences are much, much longer, and the analysis is far more robust than counting of a few nucleotides.</em></p>
</div>
</div>
<div class="section" id="biopython">
<h2>Biopython<a class="headerlink" href="#biopython" title="Permalink to this headline">¶</a></h2>
<p>If you’re not familiar with Biopython, please skim our previous lesson <a class="reference external" href="https://github.com/sabeelmansuri/binf_crash_course/blob/master/4_Biopython">here</a>.</p>
<p><strong>If you know what you’re doing, running this on your own machine instead of on EC2 will probably give you some nicer graphs. This is optional, continue on EC2 if you wish!</strong></p>
<p>You’ll need to have Biopython installed to continue (done for you on EC2). Confirm by running a Python program with the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">Phylo</span>
</pre></div>
</div>
<p>If nothing shows up during execution, you’re good to go!</p>
</div>
<div class="section" id="find-the-relationships">
<h2>Find the Relationships<a class="headerlink" href="#find-the-relationships" title="Permalink to this headline">¶</a></h2>
<div class="section" id="working-with-trees">
<h3>Working with Trees<a class="headerlink" href="#working-with-trees" title="Permalink to this headline">¶</a></h3>
<p><img alt="phylo_tree" src="https://cdn.kastatic.org/ka-perseus-images/56c951f23a9092f45b66768ff611fca6debf9294.png" /></p>
<p>You’ve probably seen one or more of the phylogenetic trees diagramed above. These visually represent the heart and soul of pylogenetics. Because we use a <strong>last universal common ancestor model</strong> (LUCA model), in which the root represents an ancestral organism from which all living organisms today evolved, each evolutionary relationship can be represented by a branching of the tree.</p>
</div>
<div class="section" id="the-data">
<h3>The Data<a class="headerlink" href="#the-data" title="Permalink to this headline">¶</a></h3>
<p>Let’s see this in action with our own phylogenetic tree! Remember those five organisms we mentioned earlier? Well here they are, each with a conserved DNA region sequenced:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="mi">5</span>   <span class="mi">13</span>
<span class="n">Alpha</span>     <span class="n">AACGTGGCCACAT</span>
<span class="n">Beta</span>      <span class="n">AAGGTCGCCACAC</span>
<span class="n">Gamma</span>     <span class="n">CAGTTCGCCACAA</span>
<span class="n">Delta</span>     <span class="n">GAGATTTCCGCCT</span>
<span class="n">Epsilon</span>   <span class="n">GAGATCTCCGCCC</span>
</pre></div>
</div>
<p><em>Note: The first line is a header. The first number is the number of organisms, and the second is the length of each DNA sequence.</em></p>
<p>Copy and paste all of the data above (including the header file) into a new file called <code class="docutils literal notranslate"><span class="pre">msa.phy</span></code>. The <code class="docutils literal notranslate"><span class="pre">.phy</span></code> extension indicates that the file contains phylogenetic data.</p>
<div class="section" id="what-kind-of-data-goes-into-making-trees">
<h4>What kind of data goes into making trees?<a class="headerlink" href="#what-kind-of-data-goes-into-making-trees" title="Permalink to this headline">¶</a></h4>
<p>As with basically all other programs dealing with biological sequences, phylogenetics algorithms need you to align your sequences before you input them, so that they are easier to compare. If you are curious about different methods of alignment and their influence on the final alignment go over to our lesson on alignment <a class="reference external" href="https://github.com/sabeelmansuri/binf_crash_course/blob/master/5_Alignment">over here</a>.</p>
</div>
</div>
<div class="section" id="the-setup">
<h3>The Setup<a class="headerlink" href="#the-setup" title="Permalink to this headline">¶</a></h3>
<p>Now we’re ready to start analyzing this data. Create a new python file and add the following to import everything we need:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">Phylo</span>
<span class="kn">from</span> <span class="nn">Bio.Phylo.TreeConstruction</span> <span class="kn">import</span> <span class="n">DistanceCalculator</span>
<span class="kn">from</span> <span class="nn">Bio.Phylo.TreeConstruction</span> <span class="kn">import</span> <span class="n">DistanceTreeConstructor</span>
<span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">AlignIO</span>
</pre></div>
</div>
<p><strong>Make sure you can run this file without errors!</strong></p>
<p>Here’s some documentation that may help you if you get stuck:
<a class="reference external" href="https://biopython.org/DIST/docs/api/Bio.AlignIO-module.html">AlignIO</a>
<a class="reference external" href="https://biopython.org/DIST/docs/api/Bio.Phylo.TreeConstruction.DistanceCalculator-class.html">DistanceCalculator</a>
<a class="reference external" href="https://biopython.org/DIST/docs/api/Bio.Phylo.TreeConstruction.DistanceTreeConstructor-class.html">DistanceTreeConstructor</a></p>
<p><em>Note: If you’re not able to follow the instructions below, ask me (Sabeel) for a templated file to help guide you!</em></p>
</div>
<div class="section" id="alignment">
<h3>Alignment<a class="headerlink" href="#alignment" title="Permalink to this headline">¶</a></h3>
<p>The first step is to import the (already aligned) sequences int our program. <strong>Use AlignIO to read in the data, and store it in a variable <code class="docutils literal notranslate"><span class="pre">aln</span></code>. Print <code class="docutils literal notranslate"><span class="pre">aln</span></code> to confirm this step worked correctly.</strong></p>
</div>
<div class="section" id="distance-matrix">
<h3>Distance Matrix<a class="headerlink" href="#distance-matrix" title="Permalink to this headline">¶</a></h3>
<p>Now that we have our data, we’re interested in how similiar (or different) the sequences are from each other. The more similar, the more likely they are to be evolutionarily close. Therefore, we use a distance matrix to store information on how similar each DNA sequence is from every other sequence. <strong>Create a Distance Calculator object with the ‘identity’ model. Use it to calculate the distance matrix of the alignment, and store it in a variable <code class="docutils literal notranslate"><span class="pre">dm</span></code>.</strong></p>
</div>
<div class="section" id="phylogenetic-tree">
<h3>Phylogenetic Tree<a class="headerlink" href="#phylogenetic-tree" title="Permalink to this headline">¶</a></h3>
<p>Now, the real magic… creating the phylogenetic tree! We can use our Distance Tree Constructor to make a tree from our distance matrix. <strong>Use the UPGMA algorithm in Distance Tree Constructor to create a tree, store it in a variable <code class="docutils literal notranslate"><span class="pre">tree</span></code>.</strong></p>
</div>
<div class="section" id="visualization">
<h3>Visualization<a class="headerlink" href="#visualization" title="Permalink to this headline">¶</a></h3>
<p>Great, you’re done! Except… you’re probably interested in how your tree turned out! The simplest way to visualize your tree is to <strong>use the <code class="docutils literal notranslate"><span class="pre">Phylo.draw_ascii()</span></code> method to print the tree to the terminal.</strong> This will give you a low-detail sketch of your tree. <em>Make sure you can do this before moving forward.</em></p>
<p>You’re probably interested in a much more detailed tree, though. The <code class="docutils literal notranslate"><span class="pre">Phylo.draw()</span></code> method provides that, but requires <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> as a dependency (<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">matplotlib</span></code> if you don’t have it [EC2 does!]).</p>
</div>
<div class="section" id="interpretation">
<h3>Interpretation<a class="headerlink" href="#interpretation" title="Permalink to this headline">¶</a></h3>
<p>Phylogenetic trees are interpreted using the following terms:</p>
<p><img alt="tree" src="https://cdn.kastatic.org/ka-perseus-images/aa95c701ebf845d93fed8362da63cbcc8439fb31.png" /></p>
<p>How many common ancestors are there? What does that tell you about the relationships and evolutionary distances between the organisms.</p>
</div>
</div>
<div class="section" id="challenge-i-different-algorithms-different-results">
<h2>Challenge I: Different Algorithms, Different Results<a class="headerlink" href="#challenge-i-different-algorithms-different-results" title="Permalink to this headline">¶</a></h2>
<p>We made two algorithm choices in our pipeline above. One is the distance calculator’s model and the other is the distance tree’s model. Use the documentation to find alternate algorithms and try various combinations. You’ll see the predicted tree (and the evolutaionary relationships) change!</p>
<p>How do we know which tree is the best? Let’s look at an analogous example with phenotypic mutations that’s easier to follow than genotypic mutations. Consider the two trees below:</p>
<p><img alt="tree1" src="https://cdn.kastatic.org/ka-perseus-images/491900ea3016ffa58693d3a4a8b594706661f648.png" />
<img alt="tree2" src="https://cdn.kastatic.org/ka-perseus-images/74878b775438cc2b9b4388eefaa60af1f262b3fc.png" /></p>
<p>The first tree is a better prediction because it relies on less evolutionary events to happen independent of each other (less “parsimony”). <em>Think: If you and your roommate are both sitting on the couch eating stawberry popsicles with chia seeds, it’s more likely that the popsicles came from the same source than two independent sources.</em></p>
<p>Looking at the different trees the algorithms produced, do you have a favorite? (There’s no real right answer here… we don’t know how these sequences evolved! As long as your can justify your choice, you’re good.)</p>
<p>So, what are these models we’re switching between? Let’s take a look:</p>
<div class="section" id="distance-tree-models">
<h3>Distance Tree Models<a class="headerlink" href="#distance-tree-models" title="Permalink to this headline">¶</a></h3>
<div class="section" id="unweighted-pair-group-method-with-arithmetic-averaging-upgma">
<h4>Unweighted Pair-Group Method with Arithmetic Averaging (UPGMA)<a class="headerlink" href="#unweighted-pair-group-method-with-arithmetic-averaging-upgma" title="Permalink to this headline">¶</a></h4>
<p>This model is heavily based upon the assumption that there is an equal rate of evolution (resulting in all branch lengths being the same in the tree). <strong>This is a VERY POOR assumption</strong>, which makes this model rather unreliable.</p>
</div>
<div class="section" id="neighbor-joining-nj">
<h4>Neighbor-Joining (NJ)<a class="headerlink" href="#neighbor-joining-nj" title="Permalink to this headline">¶</a></h4>
<p>This model is an agglomerative (bottom-up, or merging) clustering method. We’ve done agglomerative clustering before <a class="reference external" href="https://github.com/ubicucsd/development_curriculum/blob/master/7_Clustering">here</a>, so take a look! Importantly, NJ allows for unequal rates of evolution, which generally improves the output tree.</p>
</div>
</div>
<div class="section" id="distance-calculation-methods">
<h3>Distance Calculation Methods<a class="headerlink" href="#distance-calculation-methods" title="Permalink to this headline">¶</a></h3>
<div class="section" id="identity">
<h4>Identity<a class="headerlink" href="#identity" title="Permalink to this headline">¶</a></h4>
<p>Distance is equal to the proportion of non matching nucleotides, so lower distance = closer relationship.</p>
</div>
<div class="section" id="blastn">
<h4>Blastn<a class="headerlink" href="#blastn" title="Permalink to this headline">¶</a></h4>
<p>Matches are worth 5 points, while mismatches are worth -4 points. The formula to calculate the final score is:
<code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">(matches*5-mismatches\*4)/(length\*5).</span></code></p>
</div>
<div class="section" id="trans">
<h4>Trans<a class="headerlink" href="#trans" title="Permalink to this headline">¶</a></h4>
<p>This scoring takes the difference in transitions(purine-&gt;purine or pyrimidine-&gt;purine) vs transversions(purine-&gt;pyrimidine and vice versa) into account. Transversions are less likely to occur, so they are scored -6 compared to the -1 for transitions. Matches are given a score of 6.</p>
</div>
</div>
</div>
<div class="section" id="acknowledgements">
<h2>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permalink to this headline">¶</a></h2>
<p>Many data and algorithms are adatpted from the offical Biopython textbook.<br />Algorithm adapted from <a class="reference external" href="https://towardsdatascience.com/">Towards Data Science</a>.<br />Diagrams adapted from <a class="reference external" href="https://www.khanacademy.org/science/biology/her/tree-of-life/a/building-an-evolutionary-tree">Khan Academy</a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="11_Challenge2.html" class="btn btn-neutral float-right" title="Challenge 2" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="9_1_Clustering.html" class="btn btn-neutral float-left" title="Clustering" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>